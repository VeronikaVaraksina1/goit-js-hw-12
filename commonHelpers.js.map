{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst buttonResults = document.querySelector('.more-results');\n\nconst modal = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst per_page = 40;\nlet page = 1;\nlet userSearch = '';\n\nform.addEventListener('submit', toForm);\nbuttonResults.addEventListener('click', toButton);\n\nasync function toForm(event) {\n  event.preventDefault();\n  buttonResults.classList.add('hide');\n  gallery.innerHTML = '';\n  page = 1;\n  userSearch = form.search.value.trim();\n\n  const images = await fetchImages();\n\n  if (images.hits.length === 0) {\n    iziToast.error({\n      position: 'topRight',\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      backgroundColor: '#fff',\n    });\n  }\n  renderImages(images);\n}\n\nasync function toButton() {\n  const images = await fetchImages();\n  loader.classList.add('hide');\n\n  if (page >= Math.ceil(images.totalHits / per_page)) {\n    buttonResults.classList.add('hide');\n    iziToast.error({\n      position: 'topRight',\n      message: \"We're sorry, but you've reached the end of search results.\",\n      backgroundColor: '#fff',\n    });\n  }\n  renderImages(images);\n  moveCard();\n}\n\nasync function fetchImages() {\n  loader.classList.remove('hide');\n\n  page += 1;\n\n  try {\n    const images = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: '41563330-08ed4e1341b4edecabdae7272',\n        q: userSearch,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: per_page,\n        page: page,\n      },\n    });\n\n    return images.data;\n  } catch (error) {\n    console.log(error.message);\n  } finally {\n    loader.classList.add('hide');\n    form.reset();\n  }\n}\n\nasync function renderImages(images) {\n  const markup = images.hits.reduce(\n    (\n      html,\n      { webformatURL, largeImageURL, tags, likes, views, comments, downloads }\n    ) => {\n      return (\n        html +\n        `<li class='gallery-item'>\n              <a class='gallery-link' href='${largeImageURL}'>\n                <img\n                    class='gallery-image'\n                    src='${webformatURL}'\n                    alt='${tags}'\n                    width='360'\n                    height='200'\n                    />\n              </a>\n              <p class='gallery-tags'>Tags: ${tags}</p>\n              <ul class='gallery-statistic'>\n                  <li><p class='statistic'>üíó Likes<span>${likes}</span></p></li>\n                  <li><p class='statistic'>üëÅÔ∏è Views<span>${views}</span></p></li>\n                  <li><p class='statistic'>üí¨ Comments<span>${comments}</span></p></li>\n                  <li><p class='statistic'>üíå Downloads<span>${downloads}</span></p></li>\n              </ul>\n            </li>`\n      );\n    },\n    ''\n  );\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n  modal.refresh();\n\n  if (\n    images.hits.length === 0 ||\n    page >= Math.ceil(images.totalHits / per_page)\n  ) {\n    buttonResults.classList.add('hide');\n  } else {\n    buttonResults.classList.remove('hide');\n  }\n}\n\nfunction moveCard() {\n  const card = document.querySelector('.gallery-item');\n  const domRect = card.getBoundingClientRect().height;\n  window.scrollBy({\n    top: domRect * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["form","gallery","loader","buttonResults","modal","SimpleLightbox","per_page","page","userSearch","toForm","toButton","event","images","fetchImages","iziToast","renderImages","moveCard","axios","error","markup","html","webformatURL","largeImageURL","tags","likes","views","comments","downloads","domRect"],"mappings":"owBAQA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAgB,SAAS,cAAc,eAAe,EAEtDC,EAAQ,IAAIC,EAAe,aAAc,CAC7C,aAAc,MACd,aAAc,GAChB,CAAC,EAEKC,EAAW,GACjB,IAAIC,EAAO,EACPC,EAAa,GAEjBR,EAAK,iBAAiB,SAAUS,CAAM,EACtCN,EAAc,iBAAiB,QAASO,CAAQ,EAEhD,eAAeD,EAAOE,EAAO,CAC3BA,EAAM,eAAc,EACpBR,EAAc,UAAU,IAAI,MAAM,EAClCF,EAAQ,UAAY,GACpBM,EAAO,EACPC,EAAaR,EAAK,OAAO,MAAM,KAAI,EAEnC,MAAMY,EAAS,MAAMC,IAEjBD,EAAO,KAAK,SAAW,GACzBE,EAAS,MAAM,CACb,SAAU,WACV,QACE,2EACF,gBAAiB,MACvB,CAAK,EAEHC,EAAaH,CAAM,CACrB,CAEA,eAAeF,GAAW,CACxB,MAAME,EAAS,MAAMC,IACrBX,EAAO,UAAU,IAAI,MAAM,EAEvBK,GAAQ,KAAK,KAAKK,EAAO,UAAYN,CAAQ,IAC/CH,EAAc,UAAU,IAAI,MAAM,EAClCW,EAAS,MAAM,CACb,SAAU,WACV,QAAS,6DACT,gBAAiB,MACvB,CAAK,GAEHC,EAAaH,CAAM,EACnBI,GACF,CAEA,eAAeH,GAAc,CAC3BX,EAAO,UAAU,OAAO,MAAM,EAE9BK,GAAQ,EAER,GAAI,CAaF,OAZe,MAAMU,EAAM,IAAI,2BAA4B,CACzD,OAAQ,CACN,IAAK,qCACL,EAAGT,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUF,EACV,KAAMC,CACP,CACP,CAAK,GAEa,IACf,OAAQW,EAAP,CACA,QAAQ,IAAIA,EAAM,OAAO,CAC7B,QAAY,CACRhB,EAAO,UAAU,IAAI,MAAM,EAC3BF,EAAK,MAAK,CACX,CACH,CAEA,eAAee,EAAaH,EAAQ,CAClC,MAAMO,EAASP,EAAO,KAAK,OACzB,CACEQ,EACA,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAGtEP,EACA;AAAA,8CACsCE;AAAA;AAAA;AAAA,2BAGnBD;AAAA,2BACAE;AAAA;AAAA;AAAA;AAAA;AAAA,8CAKmBA;AAAA;AAAA,2DAEaC;AAAA,4DACCC;AAAA,8DACEC;AAAA,+DACCC;AAAA;AAAA,mBAK3D,EACJ,EAEE1B,EAAQ,mBAAmB,YAAakB,CAAM,EAC9Cf,EAAM,QAAO,EAGXQ,EAAO,KAAK,SAAW,GACvBL,GAAQ,KAAK,KAAKK,EAAO,UAAYN,CAAQ,EAE7CH,EAAc,UAAU,IAAI,MAAM,EAElCA,EAAc,UAAU,OAAO,MAAM,CAEzC,CAEA,SAASa,GAAW,CAElB,MAAMY,EADO,SAAS,cAAc,eAAe,EAC9B,sBAAqB,EAAG,OAC7C,OAAO,SAAS,CACd,IAAKA,EAAU,EACf,SAAU,QACd,CAAG,CACH"}