{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst buttonResults = document.querySelector('.more-results');\n\nconst modal = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst per_page = 40;\nlet page = 1;\nconst totalPages = Math.ceil(500 / per_page);\nlet userSearch = '';\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  userSearch = form.search.value.trim();\n\n  try {\n    loader.classList.remove('hide');\n    const images = await fetchImages();\n    renderImages(images);\n  } catch (error) {\n    console.log(error.message);\n  } finally {\n    loader.classList.add('hide');\n    console.log();\n  }\n\n  buttonResults.addEventListener('click', async () => {\n    try {\n      loader.classList.remove('hide');\n      const images = await fetchImages();\n      renderImages(images);\n\n      if (page > totalPages) {\n        iziToast.error({\n          position: 'topRight',\n          message: \"We're sorry, there are no more posts to load\",\n        });\n      }\n\n      loader.classList.add('hide');\n    } catch (error) {\n      console.log(error.message);\n    } finally {\n      loader.classList.add('hide');\n      console.log();\n    }\n  });\n});\n\nasync function fetchImages() {\n  page += 1;\n\n  const images = await axios.get('https://pixabay.com/api/', {\n    params: {\n      key: '41563330-08ed4e1341b4edecabdae7272',\n      q: userSearch,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: per_page,\n      page: page,\n    },\n  });\n  return images.data;\n}\n\nasync function renderImages(images) {\n  const markup = images.hits.reduce(\n    (\n      html,\n      { webformatURL, largeImageURL, tags, likes, views, comments, downloads }\n    ) => {\n      return (\n        html +\n        `<li class='gallery-item'>\n              <a class='gallery-link' href='${largeImageURL}'>\n                <img\n                    class='gallery-image'\n                    src='${webformatURL}'\n                    alt='${tags}'\n                    width='360'\n                    height='200'\n                    />\n              </a>\n              <ul class='gallery-statistic'>\n                  <li><p class='statistic'>üíó Likes<span>${likes}</span></p></li>\n                  <li><p class='statistic'>üëÅÔ∏è Views<span>${views}</span></p></li>\n                  <li><p class='statistic'>üí¨ Comments<span>${comments}</span></p></li>\n                  <li><p class='statistic'>üíå Downloads<span>${downloads}</span></p></li>\n              </ul>\n            </li>`\n      );\n    },\n    ''\n  );\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n  modal.refresh();\n  buttonResults.classList.remove('hide');\n}\n"],"names":["form","gallery","loader","buttonResults","modal","SimpleLightbox","per_page","page","totalPages","userSearch","event","images","fetchImages","renderImages","error","iziToast","axios","markup","html","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"owBAQA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAgB,SAAS,cAAc,eAAe,EAEtDC,EAAQ,IAAIC,EAAe,aAAc,CAC7C,aAAc,MACd,aAAc,GAChB,CAAC,EAEKC,EAAW,GACjB,IAAIC,EAAO,EACX,MAAMC,EAAa,KAAK,KAAK,IAAMF,CAAQ,EAC3C,IAAIG,EAAa,GAEjBT,EAAK,iBAAiB,SAAU,MAAMU,GAAS,CAC7CA,EAAM,eAAc,EACpBD,EAAaT,EAAK,OAAO,MAAM,KAAI,EAEnC,GAAI,CACFE,EAAO,UAAU,OAAO,MAAM,EAC9B,MAAMS,EAAS,MAAMC,IACrBC,EAAaF,CAAM,CACpB,OAAQG,EAAP,CACA,QAAQ,IAAIA,EAAM,OAAO,CAC7B,QAAY,CACRZ,EAAO,UAAU,IAAI,MAAM,EAC3B,QAAQ,IAAG,CACZ,CAEDC,EAAc,iBAAiB,QAAS,SAAY,CAClD,GAAI,CACFD,EAAO,UAAU,OAAO,MAAM,EAC9B,MAAMS,EAAS,MAAMC,IACrBC,EAAaF,CAAM,EAEfJ,EAAOC,GACTO,EAAS,MAAM,CACb,SAAU,WACV,QAAS,8CACnB,CAAS,EAGHb,EAAO,UAAU,IAAI,MAAM,CAC5B,OAAQY,EAAP,CACA,QAAQ,IAAIA,EAAM,OAAO,CAC/B,QAAc,CACRZ,EAAO,UAAU,IAAI,MAAM,EAC3B,QAAQ,IAAG,CACZ,CACL,CAAG,CACH,CAAC,EAED,eAAeU,GAAc,CAC3B,OAAAL,GAAQ,GAEO,MAAMS,EAAM,IAAI,2BAA4B,CACzD,OAAQ,CACN,IAAK,qCACL,EAAGP,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUH,EACV,KAAMC,CACP,CACL,CAAG,GACa,IAChB,CAEA,eAAeM,EAAaF,EAAQ,CAClC,MAAMM,EAASN,EAAO,KAAK,OACzB,CACEO,EACA,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAGtEP,EACA;AAAA,8CACsCE;AAAA;AAAA;AAAA,2BAGnBD;AAAA,2BACAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2DAMgCC;AAAA,4DACCC;AAAA,8DACEC;AAAA,+DACCC;AAAA;AAAA,mBAK3D,EACJ,EAEExB,EAAQ,mBAAmB,YAAagB,CAAM,EAC9Cb,EAAM,QAAO,EACbD,EAAc,UAAU,OAAO,MAAM,CACvC"}