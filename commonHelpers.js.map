{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst buttonLoadMore = document.querySelector('.btn-load-more');\n\nconst modal = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst per_page = 40;\nlet page = 1;\nlet userSearch = '';\n\nform.addEventListener('submit', handleSubmit);\nbuttonLoadMore.addEventListener('click', handleLoadMore);\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  page = 1;\n  gallery.innerHTML = '';\n  userSearch = form.search.value.trim();\n\n  buttonLoadMore.classList.add('hide');\n  const images = await fetchImages();\n\n  if (images.hits.length === 0) {\n    iziToast.error({\n      position: 'topRight',\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      backgroundColor: '#987fbb',\n    });\n  } else if (images.hits.length < per_page) {\n    iziToast.error({\n      position: 'topRight',\n      message: \"We're sorry, but you've reached the end of search results.\",\n      backgroundColor: '#987fbb',\n    });\n  } else {\n    buttonLoadMore.classList.remove('hide');\n  }\n\n  form.reset();\n  renderImages(images);\n}\n\nasync function handleLoadMore() {\n  page += 1;\n\n  buttonLoadMore.classList.add('hide');\n  const images = await fetchImages();\n\n  if (page >= Math.ceil(images.totalHits / per_page)) {\n    iziToast.error({\n      position: 'topRight',\n      message: \"We're sorry, but you've reached the end of search results.\",\n      backgroundColor: '#987fbb',\n    });\n  } else {\n    buttonLoadMore.classList.remove('hide');\n  }\n\n  renderImages(images);\n  moveCard();\n}\n\nasync function fetchImages() {\n  loader.classList.remove('hide');\n  try {\n    const images = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: '41563330-08ed4e1341b4edecabdae7272',\n        q: userSearch,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: per_page,\n        page: page,\n      },\n    });\n    return images.data;\n  } catch (error) {\n    console.log(error.message);\n    iziToast.error({\n      position: 'topRight',\n      message: 'Sorry, service unavailable.',\n      backgroundColor: '#987fbb',\n    });\n  } finally {\n    loader.classList.add('hide');\n  }\n}\n\nfunction renderImages(images) {\n  const markup = images.hits.reduce(\n    (\n      html,\n      { webformatURL, largeImageURL, tags, likes, views, comments, downloads }\n    ) => {\n      return (\n        html +\n        `<li class='gallery-item'>\n              <a class='gallery-link' href='${largeImageURL}'>\n                <img\n                    class='gallery-image'\n                    src='${webformatURL}'\n                    alt='${tags}'\n                    width='360'\n                    height='200'\n                    />\n              </a>\n              <p class='gallery-tags'>Tags: ${tags}</p>\n              <ul class='gallery-statistic'>\n                  <li><p class='statistic'>üíó Likes<span>${likes}</span></p></li>\n                  <li><p class='statistic'>üëÅÔ∏è Views<span>${views}</span></p></li>\n                  <li><p class='statistic'>üí¨ Comments<span>${comments}</span></p></li>\n                  <li><p class='statistic'>üíå Downloads<span>${downloads}</span></p></li>\n              </ul>\n            </li>`\n      );\n    },\n    ''\n  );\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n  modal.refresh();\n}\n\nfunction moveCard() {\n  const card = document.querySelector('.gallery-item');\n  const domRect = card.getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: domRect * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["form","gallery","loader","buttonLoadMore","modal","SimpleLightbox","per_page","page","userSearch","handleSubmit","handleLoadMore","event","images","fetchImages","iziToast","renderImages","moveCard","axios","error","markup","html","webformatURL","largeImageURL","tags","likes","views","comments","downloads","domRect"],"mappings":"owBAQA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAiB,SAAS,cAAc,gBAAgB,EAExDC,EAAQ,IAAIC,EAAe,aAAc,CAC7C,aAAc,MACd,aAAc,GAChB,CAAC,EAEKC,EAAW,GACjB,IAAIC,EAAO,EACPC,EAAa,GAEjBR,EAAK,iBAAiB,SAAUS,CAAY,EAC5CN,EAAe,iBAAiB,QAASO,CAAc,EAEvD,eAAeD,EAAaE,EAAO,CACjCA,EAAM,eAAc,EACpBJ,EAAO,EACPN,EAAQ,UAAY,GACpBO,EAAaR,EAAK,OAAO,MAAM,KAAI,EAEnCG,EAAe,UAAU,IAAI,MAAM,EACnC,MAAMS,EAAS,MAAMC,IAEjBD,EAAO,KAAK,SAAW,EACzBE,EAAS,MAAM,CACb,SAAU,WACV,QACE,2EACF,gBAAiB,SACvB,CAAK,EACQF,EAAO,KAAK,OAASN,EAC9BQ,EAAS,MAAM,CACb,SAAU,WACV,QAAS,6DACT,gBAAiB,SACvB,CAAK,EAEDX,EAAe,UAAU,OAAO,MAAM,EAGxCH,EAAK,MAAK,EACVe,EAAaH,CAAM,CACrB,CAEA,eAAeF,GAAiB,CAC9BH,GAAQ,EAERJ,EAAe,UAAU,IAAI,MAAM,EACnC,MAAMS,EAAS,MAAMC,IAEjBN,GAAQ,KAAK,KAAKK,EAAO,UAAYN,CAAQ,EAC/CQ,EAAS,MAAM,CACb,SAAU,WACV,QAAS,6DACT,gBAAiB,SACvB,CAAK,EAEDX,EAAe,UAAU,OAAO,MAAM,EAGxCY,EAAaH,CAAM,EACnBI,GACF,CAEA,eAAeH,GAAc,CAC3BX,EAAO,UAAU,OAAO,MAAM,EAC9B,GAAI,CAYF,OAXe,MAAMe,EAAM,IAAI,2BAA4B,CACzD,OAAQ,CACN,IAAK,qCACL,EAAGT,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUF,EACV,KAAMC,CACP,CACP,CAAK,GACa,IACf,OAAQW,EAAP,CACA,QAAQ,IAAIA,EAAM,OAAO,EACzBJ,EAAS,MAAM,CACb,SAAU,WACV,QAAS,8BACT,gBAAiB,SACvB,CAAK,CACL,QAAY,CACRZ,EAAO,UAAU,IAAI,MAAM,CAC5B,CACH,CAEA,SAASa,EAAaH,EAAQ,CAC5B,MAAMO,EAASP,EAAO,KAAK,OACzB,CACEQ,EACA,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAGtEP,EACA;AAAA,8CACsCE;AAAA;AAAA;AAAA,2BAGnBD;AAAA,2BACAE;AAAA;AAAA;AAAA;AAAA;AAAA,8CAKmBA;AAAA;AAAA,2DAEaC;AAAA,4DACCC;AAAA,8DACEC;AAAA,+DACCC;AAAA;AAAA,mBAK3D,EACJ,EAEE1B,EAAQ,mBAAmB,YAAakB,CAAM,EAC9Cf,EAAM,QAAO,CACf,CAEA,SAASY,GAAW,CAElB,MAAMY,EADO,SAAS,cAAc,eAAe,EAC9B,sBAAqB,EAAG,OAE7C,OAAO,SAAS,CACd,IAAKA,EAAU,EACf,SAAU,QACd,CAAG,CACH"}